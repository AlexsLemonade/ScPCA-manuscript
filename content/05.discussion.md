
## Discussion 

Here we introduced the ScPCA Portal, a collection of uniformly processed, summarized single-cell and single-nuclei RNA-seq data and de-identified metadata from pediatric tumor samples available for download.
The Portal includes 500 samples from over 50 tumor types, making this the most comprehensive collection of publicly available single-cell RNA-seq datasets from pediatric tumor samples to our knowledge. 
Summarized data is available in three different formats: unfiltered, filtered, or processed objects, permitting users to choose to start from a processed object or perform their own processing, such as filtering and normalization. 
Processed objects containing normalized gene expression data, reduced dimensionality results from PCA and UMAP, and cell type annotations are provided to save researchers time and allow users to skip straight to downstream analysis, such as identifying marker genes or exploring genes of interest. 
Every library includes a quality control report, which lets users assess data quality and identify low-quality libraries that they may wish to exclude from further downstream analyses.
Standardized metadata, containing human-readable values for all fields and ontology term identifiers for a subset of metadata fields, is included in a separate metadata file and the data objects for all samples. 
This gives users any relevant clinical information they may need when performing downstream analyses. 

Data on the Portal is available as either `SingleCellExperiment` or `AnnData` objects so users can work in R or Python with the downloaded data, depending on their preference. 
Providing data as `AnnData` objects means users can easily work with ScPCA data on other platforms.
In particular, the format of the provided `AnnData` objects was designed to be mostly compliant with the requirements of CZI CELLxGENE [@doi:10.1101/2021.04.05.438318 ; @doi:10.1101/2023.10.30.563174], but these objects can also be used with UCSC cell browser [@doi:10.1093/bioinformatics/btab503] or Kanaverse [@doi:10.1101/2022.03.02.482701]. 
Additionally, users can choose to download a merged `SingleCellExperiment` or `AnnData` object containing all gene expression data and metadata from all samples in a project. 
This is helpful for those looking to analyze multiple samples simultaneously and perform analyses like differential gene expression or gene set enrichment. 

To provide users with cell type annotations, we used two automated methods, `SingleR` and `CellAssign`, which use public references. 
As the publicly available references we used do not contain tumor cells but only normal cells, we recognize that the annotations we provide are limited. 
The most optimal way to assign cell types would be to have a well-annotated reference dataset from a sample obtained from the same patient with the same diagnosis and tissue of origin, but unfortunately, this does not exist for samples available on the Portal. 
Although the annotations provided are not without limitations, these methods can provide a good starting point for users, particularly in helping to annotate populations of normal cells that may be present, as normal cells are represented in the reference.

Many samples on the Portal have additional sequencing data, including corresponding ADT data from CITE-seq, cell hashing data, bulk RNA-seq, or spatial transcriptomics, enabling users to gather more information about a single sample than they could from single-cell or single-nuclei RNA-seq alone. 
Samples with CITE-seq have additional information about cell-surface protein expression in individual cells, which can help determine cell types and correlate RNA to protein expression [@doi:10.1038/nmeth.4380]. 
Data from multiplexed libraries require an added step of demultiplexing the samples, so we include results from multiple demultiplexing approaches and allow users to choose the most appropriate method for their needs. 
If a sample has associated bulk RNA-seq, results from genetic demultiplexing are included. 
Genetic demultiplexing uses genotypes to identify which cells come from which samples, making it more reliable than methods that use HTO expression only, especially if a high amount of background HTO expression is present. 
Spatial transcriptomics data on the Portal is not single-cell resolution, making it hard to identify cell types and spatial patterns from the spatial data alone.
By providing matching single-cell RNA-seq, users can implement analysis tools, like those that use single-cell RNA-seq to deconvolute spatial data, to gain more insights about the spatial data [@doi:10.1038/s41467-023-37168-7]. 
Similarly, users can gain more insight from bulk RNA-seq data available on the Portal by integrating with single-cell RNA-seq data from the same sample.  

We also introduced our open-source and efficient workflow for uniformly processing datasets available on the Portal, scpca-nf, which is available to the entire research community. 
`scpca-nf` uses alevin-fry for gene expression quantification, making this workflow faster and more memory-efficient than other comparable workflows for quantifying single-cell data like Cell Ranger. 
In one command, `scpca-nf` can process raw data from various sequencing types, turning FASTQ files into processed `SingleCellExperiment` or `AnnData` objects ready for downstream analyses. 
<!--TODO: There was a comment about mentioning the compatibility with CZI, but I added that in an earlier paragraph, so I don't think we need the next sentence. --> 
Additionally, output `AnnData` objects are mostly consistent with the expected format for using CZI CELLxGENE, making it easy for users to visualize and analyze data produced by `scpca-nf` on other platforms.
Using Nextflow as the framework for `scpca-nf` means the workflow is both modular and portable. 
This makes it easy to add support for more modalities in the future, such as single-cell ATAC-seq, and allows others to run the workflow on their samples in their computing environment. 
The output from running `scpca-nf` on samples from pediatric tumors, cell lines, or other model organisms is eligible for submission to the Portal, enabling us to continue increasing the number of available samples without having access to raw data. 

